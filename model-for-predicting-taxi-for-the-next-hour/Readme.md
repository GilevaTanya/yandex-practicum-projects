
# Модель для прогнозирования количества заказов такси на следующий час

## **Стек:**
Python, Pandas, scikit-learn, statsmodels

## **Описание:**  
Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Постройте модель для такого предсказания.

**Задача:** Разработать модель для прогнозирования количества заказов такси на следующий час   

**Метрика:** RMSE на тестовой выборке должно быть не больше 48

**План действий:** 
- Загрузите данные и выполните их ресемплирование по одному часу.
- Проанализировать данные.
- Сделайте тестовую выборку размером 10% от исходных данных.
- Обучите разные модели с различными гиперпараметрами. 
- Проверьте данные на тестовой выборке и сделайте выводы.  
    


## **ВЫВОД:**  

**Загрузка данных и анализ:**
- Данные представлены за период с 2018-03-01 00:00:00 по 2018-08-31 23:00:00
- Хронологический порядок соблюден.
- Временной ряд не является стационарным. 
- Имеет место ярков выраженный восходящий тренд с максимумом в районе 180 
- Сезонность: пик нагрузки приходится на 00:00, минимум на 06:00. Направление движения графика меняется каждые 6 часов.
- Шумы представлены на всем периоде наблюдений.
- Сильная автокорреляция, максимум достигается на лаге в 24 и 48.

**Подготовка к обучению:**
- Созданы дополнительные параметры для построения моделей: 
    - Календарные признаки:  месяц, день и день недели.
    - отстающие признаки: взят лаг 24 согласно показателю максимальной автокорреляции 
    - скользящее среднее: размер окна - 3.
- Данные разделены на train, valid и  test, в пропорции 80/10/10 соответственно.
- Удалены NaN в трейне после создания дополнительных признаков.

**Обучение:**
- LinearRegression: RMSE на валидационной выборке - 33,95
- RidgeCV: RMSE на валидационной выборке - 34,06
- DecisionTreeRegressor: RMSE на валидационной выборке - 39,66

Обозначенный заказчиком уровень качества RMSE < 48 преодолели все модели, наилучшим образом с задачей справилась модель LinearRegression.

**Тестирование:** 

**Проверка LinearRegression на тестовой выборке показала RMSE - 45,31.** Обозначенный заказчиком уровень качества RMSE < 48 - достигнут.

Проверка на адекватность показала, что качество целевой метрики RMSE: у медианы- 58,72, по предыдущему значению - 58,85.  
Таким образом можно утверждать что обученная модель LinearRegression предсказывает данный временной ряд гораздо качественнее.
