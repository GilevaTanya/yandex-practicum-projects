# Модель по прогнозированию ухода клиент банка в ближайшее время

## **Стек:**
Python, Pandas, scikit-learn

## **Описание:** 
Из банка стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых. Предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 

## **Цель проекта:** 
Построить модель способную спрогнозировать уйдёт клиент в ближайшее время или нет, с F1-мерой не ниже 0.59.
Дополнительно измерить изменение AUC-ROC, сравнивая её значение с F1-мерой.


## **План проекта:**
- Загрузит и подготовить данные. 
- Исследовать баланс классов, обучите модель без учёта дисбаланса и написать предварительный вывод.
- Улучшить качество модели, учитывая дисбаланс классов. Описать изменение AUC-ROC. 
- Провести финальное тестирование и достигнуть F1-меры не ниже 0.59. 

**Описание данных:**

**Признаки**
*RowNumber* — индекс строки в данных  
*CustomerId* — уникальный идентификатор клиента  
*Surname* — фамилия  
*CreditScore* — кредитный рейтинг  
*Geography* — страна проживания  
*Gender* — пол  
*Age* — возраст  
*Tenure* — сколько лет человек является клиентом банка  
*Balance* — баланс на счёте  
*NumOfProducts* — количество продуктов банка, используемых клиентом  
*HasCrCard* — наличие кредитной карты  
*IsActiveMember* — активность клиента  
*EstimatedSalary* — предполагаемая зарплата  

**Целевой признак**  
*Exited* — факт ухода клиента


## **Вывод:**
Дисбаланс классов составляет 80% на 20%.**
Для борьбы с дисбалансом, я использую следующие методы: `взвешивание классов`, `upsampling`и `downsampling`.
По итогу проведенного исследования наилучший показатель F1-меры был достигнут моделью Случайного леса, при взвешивании классов, который составил 0,62.  
Данная модель была использовать для финального тестирования.
Параметр **AUC-ROC** я измеряла на в каждой модели и можно отметить что AUC показывает более оптимистичную оценку модели поскольку усредняет пороговые значения, в отличии от чем F1-меры, которая является средним гармоническим между Полнотой и Точностью.
Что очень сильно было заметно при расчете метрик Случайного леса где был дисбаланс классов. F1-мера составила 0,11, а AUC при этом был 0,81 что является высоким показателем, но при этом вероятность предсказания положительного класса recall, почти на "0".  

Финальное тестирование модели Случайный лес, при взвешивании классов: количество деревьев - 100, количество ветвей - 18.
**F1-мера на тестовой выборке составила - 0.61, целевое значение F1-мера:0.59 - достигнуто.**

